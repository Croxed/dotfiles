#!/bin/sh
#
# ufetch-openbsd - tiny system info for openbsd
#

## INFO

# user is already defined
HOST="$(hostname)"
OS="$(uname -sr)"
KERNEL="$(uname -v)"
UPTIME="$(uptime | awk -F, '{sub(".*up ",x,$1);print $1}' | sed -e 's/^[ \t]*//')"
PACKAGES="$(ls /usr/local/Cellar | wc -l | sed -e 's/^[ \t]*//')"
# shell is already defined

if [[ "$OS" =~ Darwin* ]]; then
    osx_version="$(sw_vers -productVersion)"
    osx_build="$(sw_vers -buildVersion)"

case "${osx_version%.*}" in
      "10.4") codename="Mac OS X Tiger" ;;
      "10.5") codename="Mac OS X Leopard" ;;
      "10.6") codename="Mac OS X Snow Leopard" ;;
      "10.7") codename="Mac OS X Lion" ;;
      "10.8") codename="OS X Mountain Lion" ;;
      "10.9") codename="OS X Mavericks" ;;
      "10.10") codename="OS X Yosemite" ;;
      "10.11") codename="OS X El Capitan" ;;
      "10.12") codename="macOS Sierra" ;;
      *) codename="Mac OS X" ;;
      esac
      OS="$codename $osx_version"
      WM="Quartz Compositor"
      KERNEL="$(uname -sr)"
else
    WM=$(tail -n 1 "$HOME/.xinitrc" | cut -d ' ' -f 2)
fi

## DEFINE COLORS
c00=$'\e[0;30m'
c01=$'\e[0;31m'
c02=$'\e[0;32m'
c03=$'\e[0;33m'
c04=$'\e[0;34m'
c05=$'\e[0;35m'
c06=$'\e[0;36m'
c07=$'\e[0;37m'
c08=$'\e[1;30m'
c09=$'\e[1;31m'
c10=$'\e[1;32m'
c11=$'\e[1;33m'
c12=$'\e[1;34m'
c13=$'\e[1;35m'
c14=$'\e[1;36m'
c15=$'\e[1;37m'

f0=$'\e[1;30m'
f1=$'\e[1;37m'
f2=$'\e[0;37m'

## OUTPUT

cat <<EOF

                ${f0} ${c12}${USER}${c10}@${c12}${HOST}
    ${c06}▉▉  |
    ${c11}  ▉▉| ${f1}OS ${f0}........... $f2${OS}
    ${c13}▉▉  | ${f1}packages ${f0}..... $f2${PACKAGES}
    ${c02}  ▉▉| ${f1}uptime ${f0}....... $f2${UPTIME}
    ${c14}▉▉  | ${f1}kernel ${f0}....... $f2${KERNEL}
    ${c15}  ▉▉| ${f1}wm ${f0}........... $f2${WM}
    ${c12}▉▉  | ${f1}shell ${f0}........ $f2$SHELL
    ${c03}  ▉▉| ${f1}terminal ${f0}..... $f2$TERM
    ${c13}▉▉  |

EOF
